{% extends 'base.html.twig' %}

{% block title %}Home!{% endblock %}
{% block body %}
<div class="container" id="postsDisplayed">
    <div class="d-flex flex-row justify-content-around flex-wrap mb-2 mt-5">
        {% for post in posts|slice(0,12) %}

        {% include "home/displayPosts.html.twig" %}
        {% endfor %}

    </div>

</div>
{% block javascript %}
<script type="text/javascript">
    let counter = 3;

    let viewMorePosts = document.querySelector('#viewMorePosts')
    let postsDisplayed = document.querySelector('#postsDisplayed')


    function displayNewPosts(newdata) {
        console.log(newdata);
        let newPosts = document.createElement("span");
        newPosts.innerHTML = newdata;
        postsDisplayed.append(newPosts);
        counter += 10
    }


    window.addEventListener('scroll', (event) => {
        if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {
            console.log(counter)
            fetch("http://localhost:8000/post/displayPosts/" + counter)
                .then(response => response.text())
                .then(data => displayNewPosts(data))
        }
    })

</script>
{% endblock %}
{% endblock %}